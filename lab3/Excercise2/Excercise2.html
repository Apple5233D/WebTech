<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Smart Cart - India Edition</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 30px; background-color: #f9f9f9; }
        .container { max-width: 900px; margin: auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .product-shelf { margin-bottom: 25px; padding: 20px; border: 2px dashed #2874f0; border-radius: 8px; background: #f1f3f6; }
        button { cursor: pointer; padding: 10px 15px; margin: 5px; border-radius: 4px; border: none; transition: 0.3s; }
        .btn-add { background-color: #2874f0; color: white; font-weight: bold; }
        .btn-add:hover { background-color: #1259c7; }
        .btn-remove { background-color: #ff4343; color: white; padding: 5px 10px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border-bottom: 1px solid #ddd; padding: 15px; text-align: left; }
        th { background-color: #2874f0; color: white; }
        .summary { margin-top: 30px; text-align: right; padding: 20px; border-top: 2px solid #eee; }
        .rupee::before { content: "â‚¹"; margin-right: 2px; }
        input[type="text"] { padding: 10px; width: 200px; border: 1px solid #ccc; border-radius: 4px; }
    </style>
</head>
<body>

<div class="container">
    <h2><span style="color: #2874f0;">ðŸ›’</span> Intelligent Shopping Cart</h2>

    <div class="product-shelf">
        <strong>Available Products:</strong><br><br>
        <button class="btn-add" onclick="addItem('Smartphone', 15000, 'Electronics')">Add Smartphone (â‚¹15,000)</button>
        <button class="btn-add" onclick="addItem('Headphones', 2500, 'Electronics')">Add Headphones (â‚¹2,500)</button>
        <button class="btn-add" onclick="addItem('Textbook', 800, 'Education')">Add Textbook (â‚¹800)</button>
    </div>

    <table>
        <thead>
            <tr>
                <th>Item</th>
                <th>Category</th>
                <th>Price</th>
                <th>Qty</th>
                <th>Total</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="cartTableBody">
            </tbody>
    </table>

    <div class="summary">
        <input type="text" id="couponCode" placeholder="Try SAVE20-PROMO">
        <button style="background: #388e3c; color: white;" onclick="renderCart()">Apply</button>
        
        <p>Subtotal: <span id="subTotal" class="rupee">0</span></p>
        <p>Discounts: <span id="saveTotal" class="rupee" style="color: #388e3c;">0</span></p>
        <hr>
        <h3>Grand Total: <span id="grandTotal" class="rupee">0</span></h3>
    </div>
</div>

<script>
    let cart = [];


    function formatINR(amount) {
        return Number(amount).toLocaleString('en-IN', {
            minimumFractionDigits: 2,
            maximumFractionDigits: 2
        });
    }

    function addItem(name, price, category) {
        const existingItem = cart.find(item => item.name === name);
        if (existingItem) {
            existingItem.qty += 1;
        } else {
            cart.push({ name, price, category, qty: 1 });
        }
        renderCart();
    }

    function removeItem(index) {
        cart.splice(index, 1);
        renderCart();
    }

    function renderCart() {
        const tableBody = document.getElementById('cartTableBody');
        const couponInput = document.getElementById('couponCode').value.trim().toUpperCase();
        tableBody.innerHTML = '';
        
        let runningSubtotal = 0;
        let totalSavings = 0;

        cart.forEach((item, index) => {
            let itemCost = item.price * item.qty;
            runningSubtotal += itemCost;

            // RULE 1: Bulk Discount (10% off for 3+ items)
            if (item.qty >= 3) {
                totalSavings += (itemCost * 0.10);
            }


            if (item.category === 'Electronics') {
                totalSavings += (itemCost * 0.15);
            }

            tableBody.innerHTML += `
                <tr>
                    <td>${item.name}</td>
                    <td>${item.category}</td>
                    <td class="rupee">${formatINR(item.price)}</td>
                    <td>${item.qty}</td>
                    <td class="rupee">${formatINR(itemCost)}</td>
                    <td><button class="btn-remove" onclick="removeItem(${index})">Remove</button></td>
                </tr>
            `;
        });


        if (couponInput.startsWith("SAVE") && couponInput.endsWith("-PROMO")) {
            const discountPercent = parseInt(couponInput.substring(4, 6));
            if (!isNaN(discountPercent)) {
                totalSavings += (runningSubtotal * (discountPercent / 100));
            }
        }


        document.getElementById('subTotal').innerText = formatINR(runningSubtotal);
        document.getElementById('saveTotal').innerText = formatINR(totalSavings);
        document.getElementById('grandTotal').innerText = formatINR(runningSubtotal - totalSavings);
    }
</script>

</body>
</html>